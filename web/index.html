<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
       <!--<link rel="icon" href="../../favicon.ico"> -->

    <title>Justified Nav Template for Bootstrap</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <!-- Custom styles for this template -->
    <link href="https://getbootstrap.com/examples/justified-nav/justified-nav.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="http://getbootstrap.com/assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="https://www.parsecdn.com/js/parse-1.6.2.min.js"></script>

    <script>
      function getParameterByName(name) {
        name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
            results = regex.exec(location.search);
        return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
      }

      $( document ).ready(function() {
        console.log( "ready!" );
        Parse.initialize("j8gPtolTeQ9lyCeT71kLUTNRDGM1x92UFy1dtYpT", "FKmwUpRdLxFt23sD8FkKmbe1hQ1X31PFhNpAU0Ux");

        /*
        var AudioComment = Parse.Object.extend("AudioComment");
        var audioComment = new AudioComment();
        audioComment.set("newsId", "ABBER");
        audioComment.set("userId", 1337);
        audioComment.set("newsUrl", "http://www.lanacion.com.ar/1831219-emotivo-encuentro-del-papa-francisco-con-chicos-e-inmigrantes-en-una-escuela-del-harlem");
        audioComment.set("audioUrl", "http://www.w3schools.com/html/horse.ogg");

        audioComment.save(null, {
          success: function(audioComment) {
            // Execute any logic that should take place after the object is saved.
            alert('New object created with objectId: ' + audioComment.id);
          },
          error: function(audioComment, error) {
            // Execute any logic that should take place if the save fails.
            // error is a Parse.Error with an error code and message.
            alert('Failed to create new object, with error code: ' + error.message);
          }
        });
        
*/
        var userId = getParameterByName("userId");
        var newsUrl = getParameterByName("newsUrl");

        $("#newIframe").attr("src", newsUrl);

        /*var AudioComment = Parse.Object.extend("AudioComment");
        var query = new Parse.Query(AudioComment);
        query.get(id, {
          success: function(audioComment) {
            // The object was retrieved successfully.
            console.log(audioComment);
          },
          error: function(object, error) {
            // The object was not retrieved successfully.
            // error is a Parse.Error with an error code and message.
          }
        });*/
        
        var AudioComment = Parse.Object.extend("AudioComment");
        var query = new Parse.Query(AudioComment);
        query.equalTo("userId", parseInt(userId));
        query.equalTo("newsUrl", newsUrl);

        query.find({
          success: function(results) {
            var url = "";
            for (var i = 0; i < results.length; i++) {
              var object = results[i];
              var audioUrl = object.get('audioUrl');

              var audioHtml = '<div>';
              audioHtml += '  <h2 id="comment">Audio Comment '+ (i+1)+'</h2>';
              audioHtml += '  <audio controls>';
              audioHtml += '    <source src="' + audioUrl + '" type="audio/ogg">';
              audioHtml += '  Your browser does not support the audio element.';
              audioHtml += '  </audio>';
              audioHtml += '</div>';

              $('#audio').append(audioHtml);
              console.log(object.id + ' - ' + object.get('userId'));
            }
          },
          error: function(error) {
            alert("Error: " + error.code + " " + error.message);
          }
        });


      });
    </script>


  </head>

  <body>

    <div class="container">

      <!-- The justified navigation menu is meant for single line per list item.
           Multiple lines will require custom code not provided by Bootstrap. -->
      <div class="masthead">
        <h3 class="text-muted">Project name</h3>
        <nav>
          <ul class="nav nav-justified">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#">Projects</a></li>
            <li><a href="#">Services</a></li>
            <li><a href="#">Downloads</a></li>
            <li><a href="#">About</a></li>
            <li><a href="#">Contact</a></li>
          </ul>
        </nav>
      </div>


      <!-- Example row of columns -->
      <div class="row" style="height: 12000px;">
        <div class="col-lg-8" style="height: 100%;">

          <iframe id="newIframe" frameborder="0" scrolling="no"  style="height: 100% ; width: 100%" title="sample">
  &lt;p&gt;iframes are not supported by your browser.&lt;/p&gt;
          </iframe>

        </div>
 
        <div id="audio" class="col-lg-4">

        </div>
      </div>

      <!-- Site footer -->
      <footer class="footer">
        <p>&copy; Company 2014</p>
      </footer>

    </div> <!-- /container -->


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
  </body>
</html>
